May 09 14:42:38 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X')])
May 09 14:42:38 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:42:38 +0000] "GET /id360/get_code?client_id=200&did=did%3Akey%3Az6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X HTTP/1.0" 200 18 "-" "Dart/2.19 (dart:io)"
May 09 14:42:39 ip-172-31-37-180 gunicorn[26440]: INFO:root:kyc status in db :
May 09 14:42:39 ip-172-31-37-180 gunicorn[26440]: INFO:root:did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X never did kyc
May 09 14:42:39 ip-172-31-37-180 gunicorn[26440]: INFO:root:creating dossier with token 8757ae6acc09267083d1c6b1a1d4ece3a8fe15657a73672ad9
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]: INFO:root:{'url': 'http://preprod.id360docaposte.com/private/api/1.0.0/enrollment/19402', 'id': 19402, 'process': 4074, 'api_key': '07115d7d8e2962a68d06fe881b93a3629fb498870167b2e6ad157ff07e9ce39874505a21f753e73d03bf0ce9f306d8cb87ba50dedcefbad6eb8810df354b7e60', 'callback_url': 'https://talao.co/id360/callback_id360/nnsawg', 'browser_callback_url': 'https://talao.co/id360/issuer/nnsawg', 'client_reference': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X', 'status': 'NEW', 'reason': None, 'creation_time': '2023-05-09T14:42:42.390308', 'starting_time': None, 'finished_time': None}
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('vc_type', 'VerifiableId'), ('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'), ('callback', 'https://app.altme.io/app/download')])
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]: redis
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]: {'is_code_valid': 'True', 'client_id': '200', 'did': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'}
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]: logged None
May 09 14:42:40 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:42:40 +0000] "GET /id360/authenticate/nnsawg?vc_type=VerifiableId&client_id=200&did=did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X&callback=https://app.altme.io/app/download HTTP/1.0" 302 611 "-" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:44:16 ip-172-31-37-180 gunicorn[26440]: INFO:root:reception of id360 callback for nnsawg
May 09 14:44:16 ip-172-31-37-180 gunicorn[26440]: INFO:root:callback for wallet DID = did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X
May 09 14:44:16 ip-172-31-37-180 gunicorn[26440]: {'id': 19402, 'status': 'STARTED', 'reason': None, 'steps_status': {'done': 1, 'total': 6}, 'enrollment_step': {'status': 'OK', 'errors': [], 'type': 'LeiaFakePhotoIdCardStep', 'reason': '', 'name': 'fake_photo_id', 'documents': ['id_document_image']}}
May 09 14:44:16 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:44:16 +0000] "POST /id360/callback_id360/nnsawg HTTP/1.0" 200 5 "-" "python-requests/2.28.2"
May 09 14:44:17 ip-172-31-37-180 gunicorn[26440]: INFO:root:reception of id360 callback for nnsawg
May 09 14:44:17 ip-172-31-37-180 gunicorn[26440]: INFO:root:callback for wallet DID = did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X
May 09 14:44:17 ip-172-31-37-180 gunicorn[26440]: {'id': 19402, 'status': 'STARTED', 'reason': None, 'steps_status': {'done': 2, 'total': 6}, 'enrollment_step': {'status': 'OK', 'errors': [], 'type': 'SDRIdentityDocumentStep', 'reason': '', 'name': 'id_document', 'documents': ['id_document_image']}}
May 09 14:44:17 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:44:17 +0000] "POST /id360/callback_id360/nnsawg HTTP/1.0" 200 5 "-" "python-requests/2.28.2"
May 09 14:44:27 ip-172-31-37-180 gunicorn[26440]: INFO:root:reception of id360 callback for nnsawg
May 09 14:44:27 ip-172-31-37-180 gunicorn[26440]: INFO:root:callback for wallet DID = did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X
May 09 14:44:27 ip-172-31-37-180 gunicorn[26440]: {'id': 19402, 'status': 'STARTED', 'reason': None, 'steps_status': {'done': 3, 'total': 6}, 'enrollment_step': {'status': 'OK', 'errors': [], 'type': 'LeiaPhoneDetection', 'reason': '', 'name': 'phone_detection', 'documents': ['id_document_image']}}
May 09 14:44:27 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:44:27 +0000] "POST /id360/callback_id360/nnsawg HTTP/1.0" 200 5 "-" "python-requests/2.28.2"
May 09 14:44:30 ip-172-31-37-180 gunicorn[26440]: INFO:root:reception of id360 callback for nnsawg
May 09 14:44:30 ip-172-31-37-180 gunicorn[26440]: INFO:root:callback for wallet DID = did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X
May 09 14:44:30 ip-172-31-37-180 gunicorn[26440]: {'id': 19402, 'status': 'STARTED', 'reason': None, 'steps_status': {'done': 4, 'total': 6}, 'enrollment_step': {'status': 'OK', 'errors': [], 'type': 'LeiaFaceCompareStep', 'reason': '', 'name': 'facecomparison', 'documents': ['id_document_image', 'selfie_image']}}
May 09 14:44:30 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:44:30 +0000] "POST /id360/callback_id360/nnsawg HTTP/1.0" 200 5 "-" "python-requests/2.28.2"
May 09 14:44:46 ip-172-31-37-180 gunicorn[26440]: INFO:root:reception of id360 callback for nnsawg
May 09 14:44:46 ip-172-31-37-180 gunicorn[26440]: INFO:root:callback for wallet DID = did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X
May 09 14:44:46 ip-172-31-37-180 gunicorn[26440]: {'id': 19402, 'status': 'STARTED', 'reason': None, 'steps_status': {'done': 5, 'total': 6}, 'enrollment_step': {'status': 'OK', 'errors': [], 'type': 'LeiaFaceChallengeStep', 'reason': '', 'name': 'liveness', 'documents': ['liveness_video$1']}}
May 09 14:44:46 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:44:46 +0000] "POST /id360/callback_id360/nnsawg HTTP/1.0" 200 5 "-" "python-requests/2.28.2"
May 09 14:45:39 ip-172-31-37-180 gunicorn[26440]: redis1
May 09 14:45:39 ip-172-31-37-180 gunicorn[26440]: redis
May 09 14:45:39 ip-172-31-37-180 gunicorn[26440]: {'is_code_valid': 'True', 'client_id': '200', 'did': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X', 'token': '8757ae6acc09267083d1c6b1a1d4ece3a8fe15657a73672ad9', 'vc_type': 'VerifiableId', 'site_callback': 'https://app.altme.io/app/download', 'first': True, 'id_dossier': 19402}
May 09 14:45:39 ip-172-31-37-180 gunicorn[26440]: logged True
May 09 14:45:39 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:39 +0000] "GET /id360/issuer/nnsawg?token=c1592983431caf6b540cab4210a3a8fe1c0fea41eacb55bce41f424886a5573106043fa53ad83507420cca4e8649cb7cbd81da07cb393d75eedbfdc7a2060f52 HTTP/1.0" 200 8523 "https://preprod.id360docaposte.com/" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:45:40 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:40 +0000] "GET /id360/static/style_mobile.css HTTP/1.0" 304 0 "https://talao.co/id360/issuer/nnsawg?token=c1592983431caf6b540cab4210a3a8fe1c0fea41eacb55bce41f424886a5573106043fa53ad83507420cca4e8649cb7cbd81da07cb393d75eedbfdc7a2060f52" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:45:40 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:40 +0000] "GET /id360/static/card.png HTTP/1.0" 200 0 "https://talao.co/id360/issuer/nnsawg?token=c1592983431caf6b540cab4210a3a8fe1c0fea41eacb55bce41f424886a5573106043fa53ad83507420cca4e8649cb7cbd81da07cb393d75eedbfdc7a2060f52" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:45:40 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:40 +0000] "GET /id360/static/Arrow-right.png HTTP/1.0" 304 0 "https://talao.co/id360/issuer/nnsawg?token=c1592983431caf6b540cab4210a3a8fe1c0fea41eacb55bce41f424886a5573106043fa53ad83507420cca4e8649cb7cbd81da07cb393d75eedbfdc7a2060f52" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:45:40 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:40 +0000] "GET /id360/static/Nunito-VariableFont_wght.ttf HTTP/1.0" 304 0 "https://talao.co/id360/static/style_mobile.css" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]: ERROR:main:Exception on /id360/issuer_endpoint/nnsawg [GET]
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]: Traceback (most recent call last):
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/flask/app.py", line 2528, in wsgi_app
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     response = self.full_dispatch_request()
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/flask/app.py", line 1825, in full_dispatch_request
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     rv = self.handle_user_exception(e)
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/flask/app.py", line 1823, in full_dispatch_request
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     rv = self.dispatch_request()
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/flask/app.py", line 1799, in dispatch_request
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/asgiref/sync.py", line 240, in __call__
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     return call_result.result()
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 433, in result
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     return self.__get_result()
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/usr/local/lib/python3.9/concurrent/futures/_base.py", line 389, in __get_result
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     raise self._exception
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/venv/lib/python3.9/site-packages/asgiref/sync.py", line 306, in main_wrap
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     result = await self.awaitable(*args, **kwargs)
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:   File "/home/achille/id360/main.py", line 458, in vc_endpoint
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:     credential["credentialSubject"]["familyName"] = dossier["extracted_data"]["identity"][0]["name"]
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]: TypeError: 'int' object is not subscriptable
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]: 202
May 09 14:45:57 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:45:57 +0000] "GET /id360/issuer_endpoint/nnsawg HTTP/1.0" 500 265 "-" "Dart/2.19 (dart:io)"
May 09 14:48:50 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X')])
May 09 14:48:50 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:48:50 +0000] "GET /id360/get_code?client_id=200&did=did%3Akey%3Az6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X HTTP/1.0" 200 18 "-" "Dart/2.19 (dart:io)"
May 09 14:48:51 ip-172-31-37-180 gunicorn[26440]: INFO:root:kyc status in db :
May 09 14:48:51 ip-172-31-37-180 gunicorn[26440]: INFO:root:did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X never did kyc
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: INFO:root:creating dossier with token 8757ae6acc09267083d1c6b1a1d4ece3a8fe15657a73672ad9
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: INFO:root:{'url': 'http://preprod.id360docaposte.com/private/api/1.0.0/enrollment/19403', 'id': 19403, 'process': 4074, 'api_key': 'c79cb3065a71c82d2c1f54106296ba5fbb0cff803ebe74413cea8ed446c747d04d8109129493a4c751b35c14074e0f1aaf2f00be82452709578e1f696909973b', 'callback_url': 'https://talao.co/id360/callback_id360/i4wpou', 'browser_callback_url': 'https://talao.co/id360/issuer/i4wpou', 'client_reference': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X', 'status': 'NEW', 'reason': None, 'creation_time': '2023-05-09T14:48:54.450966', 'starting_time': None, 'finished_time': None}
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('vc_type', 'VerifiableId'), ('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'), ('callback', 'https://app.altme.io/app/download')])
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: redis
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: {'is_code_valid': 'True', 'client_id': '200', 'did': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'}
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]: logged True
May 09 14:48:52 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:48:52 +0000] "GET /id360/authenticate/i4wpou?vc_type=VerifiableId&client_id=200&did=did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X&callback=https://app.altme.io/app/download HTTP/1.0" 302 611 "-" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
May 09 14:50:07 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X')])
May 09 14:50:07 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:50:07 +0000] "GET /id360/get_code?client_id=200&did=did%3Akey%3Az6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X HTTP/1.0" 200 18 "-" "Dart/2.19 (dart:io)"
May 09 14:50:07 ip-172-31-37-180 gunicorn[26440]: INFO:root:kyc status in db :
May 09 14:50:07 ip-172-31-37-180 gunicorn[26440]: INFO:root:did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X never did kyc
May 09 14:50:08 ip-172-31-37-180 gunicorn[26440]: INFO:root:creating dossier with token 8757ae6acc09267083d1c6b1a1d4ece3a8fe15657a73672ad9
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]: INFO:root:{'url': 'http://preprod.id360docaposte.com/private/api/1.0.0/enrollment/19404', 'id': 19404, 'process': 4074, 'api_key': '93bbe9d5a61521933f8544181ffe1e3ee29c56062334b2c94455067347447f70515559674566e942ff5a1709c61bb0ce0d23343a8532e0def71249a027b826e9', 'callback_url': 'https://talao.co/id360/callback_id360/psmjy8', 'browser_callback_url': 'https://talao.co/id360/issuer/psmjy8', 'client_reference': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X', 'status': 'NEW', 'reason': None, 'creation_time': '2023-05-09T14:50:11.058137', 'starting_time': None, 'finished_time': None}
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]: ImmutableMultiDict([('vc_type', 'VerifiableId'), ('client_id', '200'), ('did', 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'), ('callback', 'https://app.altme.io/app/download')])
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]: redis
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]: {'is_code_valid': 'True', 'client_id': '200', 'did': 'did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X'}
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]: logged None
May 09 14:50:09 ip-172-31-37-180 gunicorn[26440]:  - - [09/May/2023:14:50:09 +0000] "GET /id360/authenticate/psmjy8?vc_type=VerifiableId&client_id=200&did=did:key:z6Mkt37Pf1zF2zosNcfM2sLe1k9GLxbzdYtSLjcZ74mH8Y8X&callback=https://app.altme.io/app/download HTTP/1.0" 302 611 "-" "Mozilla/5.0 (Linux; Android 13; SM-A546B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Mobile Safari/537.36"
